#!/bin/sh
set -e # fail if we can't source the file
. ./network-secrets.env 
set -x

case $1 in
  w16gw)
    envsubst \ '
    $ddns4_domain \
    $ddns4_username \
    $ddns4_password \
    $ddns6_domain \
    $ddns6_username \
    $ddns6_password \
    $freifunk_ca_crt \
    $freifunk_client_crt \
    $freifunk_client_key \
    $imagivpn_key \
    $wg_vpn_public_key \
    $wg_vpn_private_key \
    $wg_furrow_public_key \
    $wg_furrow_private_key \
    $wg_simonphone_public_key \
    $wg_simonphone_private_key \
    $wg_f17gw_public_key \
    $wg_f17gw_private_key \
    $wg_tablet_public_key \
    $wg_tablet_private_key \
    $wg_windows_public_key \
    $wg_windows_private_key \
    $dh2048_pem \
    ' < w16gw.settings  | ssh root@10.7.11.5
    ;;

  f17gw)
    envsubst \ '
    $trusted_wifikey \
    $trusted_wifikey_baustelle \
    $f17gw_ddns4_domain \
    $f17gw_ddns4_username \
    $f17gw_ddns4_password \
    $f17gw_ddns6_domain \
    $f17gw_ddns6_username \
    $f17gw_ddns6_password \
    $wg_vpn_public_key \
    $wg_vpn_private_key \
    $wg_furrow_public_key \
    $wg_furrow_private_key \
    $wg_simonphone_public_key \
    $wg_simonphone_private_key \
    $wg_f17gw_public_key \
    $wg_f17gw_private_key \
    $pyur_community_username \
    $pyur_community_password \
    ' < f17gw.settings | ssh root@10.7.10.1
    ;;

  repeater0[1-6])
    envsubst \ '
    $trusted_wifikey \
    $iot_wifikey \
    $dual2_roaming_key \
    $freifunk_roaming_key \
    ' < nanostationm2.settings  | ssh root@$1.imagilan
    ;;

  repeater07)
    envsubst \ '
    $trusted_wifikey \
    $dual2_roaming_key \
    $freifunk_roaming_key \
    ' < mr33.settings  | ssh root@10.7.11.111
    ;;

  *)
    echo "useage: $0 <repeater0X|edgerouterx>"
  ;;
esac

